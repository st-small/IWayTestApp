# IWayTestApp
Выполнение приложения согласно техническому заданию: 
```text
Реализовать iOS приложение с архитектурой VIPER передачу координат водителем по кнопке "Передать координаты", используя наше API. Координаты можно передавать виртуальные, реализовать в приложении страницу авторизации, токен авторизации создать самостоятельно.
```
## Краткое описание
Данное задание состоит из задач:
1. Авторизация водителя.
2. Отправка данных текущей геопозиции на сервер.
3. * Добавлена функця сохранения авторизированного состояния между сеансами использования приложения.
4. * Возможность принудительного выхода из приложения (logout).

## Архитектура
Приложение разделено на сцены и выполнено с использованием чистой архитектуры.

## Задача 'Авторизация водителя'
При запуске приложения, происходит проверка на наличие сохранненых токенов предыдущих сеансов (проверяется KeychainWrapper). В зависимости от наличия/отсутствия токена, определяется стартовый экран (инстанциируется экран авторизации или таб бар с вкладками, доступными уже зарегестрированному пользователю). Такая проверка в данной реализации происходит в классе `AppDelegate`, в идеале, для такой операции следовало бы создать сервис `Launcher`. 

Экран авторизации включает в себя два текстовых поля для ввода логина и пароля, кнопки взаимодействия (отправки запроса на авторизацию). При появлении клавиатуры, ее можно скрыть касаясь свободного поля экрана. Тип клавиатуры для каждого из текстовых полей не определялся, так как, отсуствует информация о возможных значениях обоих полей. (В иделае, следовало бы ограничить ввод по количеству символов и делать проверку на остуствие специальных сиволов или букв, если они не должны использоваться). 

При подготовке отправки запроса, данные валидируются на пустое или некорректное значение, о чем уведомляется пользователь. По результату, индикатор скрывается и происходит переход в закрытую часть (если успешно), или отображается ошибка (если произошла таковая).

## Задача 'Отправка данных текущей геопозиции на сервер'
В закртытой части приложения отображается таб бар, в котором присутствуют 2 вкладки: `Features` и  `Bookmarks`. Каждая из вкладок включает в себя свой `UINavigationController`, что является удобным для реализации независимой навигации на каждой из вкладок. (В данной задаче принял решение не кастомизировать таб бар, так как реализация ТЗ этого не предусматривает, воспользовался значками по-умолчанию).

Вкладка `swiftFeatures` включает в себя кнопку `Share position`, по нажатию на которую, происходит отправка "симулятивной" геопозиции.

Для более изящного решения задачи с отправкой координат, я принял решение создать JSON файл, в котором собрал данные о более, чем 1000 городах России в таком формате:
```javascript
{
    "coords": {
        "lat": "55.75583",
        "lon": "37.61778"
    },
    "district": "Центральный",
    "name": "Москва",
    "population": 11514330,
    "subject": "Москва"
}
```
При отправке геопозиции, происходит произвольный выбор города, формируется набор данных по нему и отправляется на сервер. При успешном результате, пользователю отображается алерт с подробным описанием переданных данных (город, координаты).


## Дополнительные задачи
При авторизации пользователя, полученные токены сохраняются в `KeychainWrapper` и могут быть использованы при дальнейших запросах к серверу в данном сеансе или последующих сеансах.

В случае необходимости, пользователь может выйти из своей учетной записи на вкладке `Bookmarks`. По нажатию на кнопку, происходит удаление токенов из хранилища и переход на экран авторизации без возможности возврата в закрытую часть приложения. В случае принудительного завершения приложения, следующий запуск начнется с экрана авторизации.

## Особенности
* Приложение полностью написано без использования сторибордов и ксибов (все в коде).
* В приложении реализована адаптация под разные размеры экранов (от 4 до 6 дюймов). 
* На момент запроса, ожидания и получения ответа от сервера, пользователю отображается индикатор загрузки (`UIActivityIndicator`).
* Реализована функция инъекции зависимостей для использвания сервисов.

## Внешние зависимости
В проекте используется средство для управления зависимостями Carthage. Добавлены библиотеки:
* Alamofire - для взаимодействия с сетевыми запросами.
* SVProgressHUD - отображение состояния загрузки при сетевых обращениях или выполнении работы в фоновом потоке.
* SnapKit - библиотека упрощенной работы констрейнтами и якорями элементов интерфейса.
* DITranquility - реализация инъекций внешних зависимостей.



